
@{
    ViewBag.Title = "Index";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<h2>Customers</h2>
<div class="navbar-right">
    <button onclick="location.href='@Url.Action("New", "Customer")'" ;return false;><i class="btn btn-info">Add Customer</i></button>
</div>

<table id="customers" class="table-hover table-bordered table-striped">
    <thead>
        Customers Data
    </thead>
    <tbody>
        <tr>
            <th>
                Name
            </th>
            <th>
                Id
            </th>
            <th>
                Subscribed To Newsletter
            </th>
            <th>

                Membership Type
            </th>
            <th>
                Discount rate
            </th>
            <th>
                Year Of Birth
            </th>

            <th>
                Details
            </th>
            <th>
                Edit
            </th>
            <th>
                Delete
            </th>
        </tr>

        @foreach (var customer in Model)
        {
            <tr>
                <td>
                    @customer.Name
                </td>
                <td>
                    @customer.Id
                </td>
                <td>
                    @customer.IsSubscribedToNewsletter
                </td>
                <td>
                    @customer.MembershipType.Name
                </td>
                <td>
                    @customer.MembershipType.DiscountRate%
                </td>

                <td>
                    @{
                        var Birthdate = customer.Birthdate.Year;
                     }

                    @Birthdate

                </td>
                <td>
                    <button onclick="location.href='@Url.Action("Det", new { id = customer.Id })';return false;" class="btn btn-info">Details</button>
                </td>
                <td>
                    <button onclick="location.href='@Url.Action("Edit", new { id = customer.Id })';return false;" class="btn btn-primary">Edit</button>
                </td>
                <td>
                   <button data-customer-id="@customer.Id" class="btn btn-link btn-danger js-delete">Delete</button>
                </td>
             </tr>

        }
    </tbody>
</table>
@section scripts{

<script>
    $(document).ready(function () {
        $("#customers .js-delete").on("click", function () {
            var button = $(this);
            bootbox.confirm("Are you sure you want to delete this Customer?", function (result) {
                if (result) {
                    $.ajax
                        (
                            {
                                url: "/api/customers/" + button.attr("data-customers-id"),
                                method: "DELETE",
                                success: function () {
                                    button.parents("tr").remove();
                                }
                            }
                         );
                }
            });
        });
    });
</script>
}
